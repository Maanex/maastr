/*! maastr 1.0 (c) 2020 Andreas May */
(function(){"use strict";return this.maastr={},this.maastr.default={tokens:{"**":"bold",__:"underline","~~":"strikethrough","*":"italic"},settings:{htmlTag:"span",prefix:"",suffix:""}},this.maastr.parse=function(t,e=maastr.default.tokens,l=maastr.default.settings){let s={};for(let t in e)"string"==typeof e[t]?s[t]=[e[t],!1,!1]:s[t]=[e[t][0],!!e[t][1],!!e[t][2]];e=s;let a=[[]],n="",r=t.split(""),i="",h=0;for(let t=0;t<r.length;t++){let l=r[t],s=n+l;2==s.length&&e[s]?(i=i.substr(0,i.length-1),e[s][2]=!e[s][2],n="",h--):!e[l]||t+1<r.length&&e[l+r[t+1]]?(i+=l,n=l,h++):(e[l][2]=!e[l][2],n=""),a[h]=[];for(let t of Object.values(e))t[2]&&a[h].push(t)}if(t=i,i="",Object.keys(a).length){for(let e=0;e<t.length;e++){let s=[],n=[],r=0;for(let l of a[e])l[1]?s.push(l[0]):0!=e&&a[e-1].filter(t=>t[0]==l[0]).length?e!=t.length-1&&a[e+1].filter(t=>t[0]==l[0]).length||r++:n.push(l[0]);let h=t.split("")[e];if(s.length&&(" "==h&&(h="&nbsp;"),h=`<${l.htmlTag} class="${s.join(" ")}">${h}</${l.htmlTag}>`),n.length)for(let t of n)h=`<${l.htmlTag} class="${t}">${h}`;r&&(h+=`</${l.htmlTag}>`.repeat(r)),i+=h}i=l.prefix+i+l.suffix}return i||t},this.maastr}).call(this);
